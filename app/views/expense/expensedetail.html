<div class="container" ng-init="loadexpensedata()">
    <form id="ExpDetail
" method="post" class="form-inline" novalidate>
        <fieldset ng-disabled="OverageDisable">
            <div class="form-group">
                <a ng-href="#/expense/viewexpense" class="btn btn-primary format_button_mm">Go Back to Expense List</a>
                <br/>
            </div>
            <div class="panel panel-default" ng-repeat="dexedit in expense">
                <div class="panel-heading clearfix">
                    <b> <h3 class="panel-title pull-left">Expense Detail</h3></b>
                </div>
                <div class="form-group form-inline" style="padding-top: 6px;  padding-bottom:  6px;">
                    <div class="form-group row">
                        <label for="leventdate" class="col-xs-6 col-form-label">Event Date</label>
                        <div class="col-xs-10">
                            <label id="leventdate" class=" form-control" placeholder="0" ng-model="dexedit.eventdate">
                                {{dexedit.eventdate}}</label>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="lchapter" class="col-xs-6 col-form-label">Chapter Name </label>
                        <div class="col-xs-10">
                            <label id="lchapter" class=" form-control" ng-model="dexedit.Chapter">
                                {{dexedit.Chapter}}</label>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="ltotalcost" class="col-xs-6  col-form-label">Total Expense</label>
                        <div class="col-xs-10">
                            <label id="ltotalcost" class=" form-control " ng-model="dexedit.Amount">
                                {{ ((dexedit.Line[0].Quantity * dexedit.Line[0].Rate) + (dexedit.Line[1].Quantity * dexedit.Line[1].Rate) + (TotalLineCost * 1)) | currency}}
                            </label>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="lsubmitby" class="col-xs-6 col-form-label">Created By</label>
                        <div class="col-xs-10">
                            <label id="lsubmitby" class=" form-control" ng-model="dexedit.SubmitBy">
                                {{dexedit.SubmitBy}}</label>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="lsubmitdate" class="col-xs-6 col-form-label">Created On</label>
                        <div class="col-xs-10">
                            <label id="lsubmitdate" class=" form-control" ng-model="dexedit.SubmitDate">
                                {{dexedit.SubmitDate}}</label>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="lsubmitaddress" class="col-xs-6 col-form-label">Address</label>
                        <div class="col-xs-12">
                            <label id="lsubmitaddress" class=" form-control" ng-model="dexedit.SubmitAddress" style=" word-wrap: break-word">
                                {{dexedit.SubmitAddress}}</label>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="lPaymentStatus" class="col-xs-8 col-form-label">Payment Status</label>
                        <div class="col-xs-10">
                            <label id="lPaymentStatus" class=" form-control" ng-model="dexedit.PaymentStatus">
                                {{dexedit.PaymentStatus}}</label>
                        </div>
                    </div>
                    <div class="form-group row">
                        <button type="button" class="btn btn-default" ng-click="open()">Payment Status Log</button>
                    </div>
                    <div class="form-group row" style="padding-bottom:  6px;">
                        <label for="lDescription" class="col-xs-12 col-form-label">Business purpose, Origin and Destination</label>
                        <div class="col-md-8">
                            <input id="lDescription" ng-model="dexedit.Description" type="text" class="form-control" title="Business purpose, Origin & Destination" size="120" placeholder="Business purpose, Origin & Destination" required>
                        </div>
                    </div>
                    <!-- </fieldset> -->
                    <div class="form-group   panel panel-default">
                        <div class="panel-heading"><b>Mileage for Travel</b></div>
                        <div class="panel-body">
                            <div class="form-group row">
                                <label for="lquantity1" class="col-xs-6 col-form-label">Miles Driven</label>
                                <div class="col-xs-10">
                                    <input id="lquantity1" ng-model="dexedit.Line[0].Quantity" name="miles" class="form-control" placeholder="0" type="number" min="1" pattern="\d+">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="lrate1" class="col-xs-6 col-form-label">Mile Rate</label>
                                <div class="col-xs-10">
                                    <input id="lrate1" ng-model="dexedit.Line[0].Rate" name="miles" class="form-control" placeholder="0.25" type="number" step="0.01" pattern="\d+.\d+">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="lamount1" class="col-xs-6 col-form-label">Amount</label>
                                <div class="col-xs-10">
                                    <label id="lamount1" class="form-control" placeholder="0" ng-model="exp.Line[0].Amount" name="Amount1">{{ (dexedit.Line[0].Quantity * dexedit.Line[0].Rate) | currency}}</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group   panel panel-default">
                        <div class="panel-heading"><b>Mileage for Trailer Hauling</b></div>
                        <div class="panel-body">
                            <div class="form-group row">
                                <label for="lquantity2" class="col-xs-6 col-form-label">Trailer Miles</label>
                                <div class="col-xs-10">
                                    <input id="lquantity2" ng-model="dexedit.Line[1].Quantity" name="trailermiles" class="form-control" placeholder="0" type="number" min="1" pattern="\d+">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="lrate2" class="col-xs-6 col-form-label">Mile Rate</label>
                                <div class="col-xs-10">
                                    <input id="lrate2" ng-model="dexedit.Line[1].Rate" name="milerate" class="form-control" placeholder="0.4" type="number" step="0.01" pattern="\d+.\d+">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="lamount2" class="col-xs-6 col-form-label">Amount</label>
                                <div class="col-xs-10">
                                    <label id="lamount2" class="form-control" placeholder="0" ng-model="exp.Line[1].Amount" name="Amount2">{{ (dexedit.Line[1].Quantity * dexedit.Line[1].Rate) | currency}}</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group   panel panel-default">
                        <div class="panel-heading"><b>Other Expenses</b>
                        </div>
                        <div class="panel-body">
                            <div style="margin: auto; display: block; padding-top: 10px" max-width="100%">
                                <table class="table table-striped table-bordered">
                                    <thead>
                                        <tr>
                                            <th>
                                                <input type="checkbox" ng-model="selectedAll" ng-click="checkAll()" />
                                            </th>
                                            <th>Description</th>
                                            <th>Amount</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="Line in LineDetails">
                                            <td>
                                                <input type="checkbox" ng-model="Line.selected" />
                                            </td>
                                            <td>
                                                <input type="text" size="80" class="form-control" ng-model="Line.Description" placeholder="Explanation of Other expenses" title="Explanation of Other expenses" required/>
                                            </td>
                                            <td>
                                                <input type="text" name="lineamount" class="form-control" ng-model="Line.Amount" required placeholder="0.0" type="number" step="0.01" pattern="\d+.\d+" ng-change="lineAmountChange()" />
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <div class="form-group" ng-show="((userRole=='Participant' || userRole=='Volunteer') && 
                            (dexedit.PaymentStatus!='Submitted'  ||  dexedit.PaymentStatus!='Paid'  ||  dexedit.PaymentStatus!='Overage'))">
                                    <input id="btn_remove" ng-model="btn_remove" ng-hide="!LineDetails.length" type="button" class="btn btn-danger pull-right" ng-click="remove()" value="Remove">
                                    <input id="btn_addNew" ng-model="btn_addNew" type="submit" class="btn btn-primary addnew pull-right" ng-click="addNew()" value="Add New">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel panel-default">
                        <div class="panel-heading clearfix">
                            <h3 class="panel-title pull-left">Bill Receipts</h3>
                        </div>
                        <div id="imagedisplay" class="form-group col-xs-12">
                            <div class="content panel-body">
                                <img id="image0" width="40%" height="40%" hidden="true" style="padding: 20px" onmouseover="image0.width='700';image0.height='450';" onmouseout="image0.width='250';image0.height='200';" />
                                <img id="image1" width="40%" height="40%" hidden="true" style="padding: 20px" onmouseover="image1.width='700';image1.height='450';" onmouseout="image1.width='250';image1.height='200';" />
                                <img id="image2" style="width:300px;height:200px;" hidden="true" onmouseover="image2.width='700';image2.height='450';" onmouseout="image2.width='250';image2.height='200';" />
                                <img id="image3" style="width:300px;height:200px;" hidden="true" onmouseover="image3.width='700';image3.height='450';" onmouseout="image3.width='250';image3.height='200';" />
                                <img id="image4" style="width:300px;height:200px;" hidden="true" onmouseover="image4.width='700';image4.height='450';" onmouseout="image4.width='250';image4.height='200';" />
                                <img id="image5" style="width:300px;height:200px;" hidden="true" onmouseover="image5.width='700';image5.height='450';" onmouseout="image5.width='250';image5.height='200';" />
                                <img id="image6" style="width:300px;height:200px;" hidden="true" onmouseover="image6.width='700';image6.height='450';" onmouseout="image6.width='250';image6.height='200';" />
                                <img id="image7" style="width:300px;height:200px;" hidden="true" onmouseover="image7.width='700';image7.height='450';" onmouseout="image7.width='250';image7.height='200';" />
                                <img id="image8" style="width:300px;height:200px;" hidden="true" onmouseover="image8.width='700';image8.height='450';" onmouseout="image8.width='250';image8.height='200';" />
                                <img id="image9" style="width:300px;height:200px;" hidden="true" onmouseover="image9.width='700';image9.height='450';" onmouseout="image9.width='250';image9.height='200';" />
                            </div>
                        </div>
                    </div>
        </fieldset>
        <div ng-show="((userRole=='Participant' || userRole=='Volunteer' || userRole=='Chapter Lead') && (useremail==expenseemail) )" class="form-group col-xs-12" style="padding-top: 6px;">
            <div class="form-group row col-xs-6" ng-show="(userRole=='Participant' || userRole=='Volunteer') &&  paystat!='Submitted' ">
                <a ng-href="#/expense/viewexpense" class="btn btn-primary format_button_sm" ng-show="(paystat!='Overage') || ((userRole=='Participant' || userRole=='Volunteer') && (paystat=='Pending' || paystat=='Resubmit' || paystat!='Submitted' )) || (userRole=='Chapter Lead'  && useremail==expenseemail  && (paystat=='Submitted'  || paystat=='Returned'))" ng-click="updateexpense(dexedit.BillId)">Save Expense</a>
                <a ng-href="#/expense/viewexpense" class="btn btn-primary format_button_sm" ng-show="( paystat!='Overage') && (paystat!='Approved') && (paystat!='Payment Issued')" ng-click="deleteexp(dexedit.BillId)">Delete Expense</a>
            </div>
            <div class="form-group row  col-xs-4">
                <a ng-href="#/expense/viewexpense" class="btn btn-primary format_button_sm" title="Go Back to View Expense List" ng-click="">Go Back</a>
            </div>
        </div>
        <div ng-show="((userRole=='Participant' || userRole=='Volunteer' || userRole=='Chapter Lead') && (useremail==expenseemail) && (dexedit.PaymentStatus=='Rejected'))" class="form-group col-xs-12" style="padding-top: 6px;">
            <div class="form-group row" style="padding-bottom:  6px;">
                <label for="lpaystatusdescription" class="col-xs-12 col-form-label">Re-Submit Reason:</label>
                <div class="col-md-8">
                    <input id="lpaystatusdescription" ng-model="resubmitreason" type="text" class="form-control" title="Payment Status NOTES - Explain the reason for changing payment status " size="120" placeholder="Explain the reason for changing payment status" required>
                </div>
            </div>
            <a ng-href="#/expense/viewexpense" class="btn btn-primary format_button_sm" ng-show="(dexedit.PaymentStatus!='Approved') && (dexedit.PaymentStatus!='Payment Issued')" ng-click="resubmitexpense(dexedit.BillId,resubmitreason)">Re-Submit</a>
            <a ng-href="#/expense/viewexpense" class="btn btn-primary format_button_sm" title="Go Back to View Expense List" ng-click="">Go Back</a>
        </div>
        <div class="panel panel-default" ng-show="(userRole=='Chapter Lead' ||  userRole=='National Staff' || userRole=='admin') && (useremail != expenseemail)">
            <div class="panel-heading clearfix">
                <h3 class="panel-title pull-left">Payment Status Review</h3>
            </div>
            <div class="content panel-body " ng-show="(userRole=='Chapter Lead')" class="form-group col-xs-12">
                <!--  div ng-show=" dexedit.PaymentStatus=='Pending' -->
                <label class="btn">
                    <input type="radio" ng-model="dexedit.PaymentStatus" value="Pending">
                    <span style=" font-size: 20px">Pending</span>
                </label>
                <label class="btn">
                    <input type="radio" ng-model="dexedit.PaymentStatus" value="Resubmit">
                    <span style=" font-size: 20px">Resubmit</span>
                </label>
                <label class="btn">
                    <input type="radio" ng-model="dexedit.PaymentStatus" value="Returned">
                    <span style=" font-size: 20px">Returned</span>
                </label>
                <label class="btn">
                    <input type="radio" ng-model="dexedit.PaymentStatus" value="Submitted">
                    <span style=" font-size: 20px">Submitted</span>
                </label>
                <label class="btn">
                    <input type="radio" ng-model="dexedit.PaymentStatus" value="Overage">
                    <span style=" font-size: 20px">Overage</span>
                </label>
                <label class="btn">
                    <input type="radio" ng-model="dexedit.PaymentStatus" value="Approved" disabled="true">
                    <span style=" font-size: 20px">Approved</span>
                </label>
                <label class="btn">
                    <input type="radio" ng-model="dexedit.PaymentStatus" value="Paid" disabled="true">
                    <span style=" font-size: 20px">Paid</span>
                </label>
                <div class="form-group row" style="padding-bottom:  6px;">
                    <label for="lpaystatusdescription" class="col-xs-12 col-form-label">Payment Status NOTES:</label>
                    <div class="col-md-8">
                        <input id="lpaystatusdescription" ng-model="dexedit.PayStatusDescription" type="text" class="form-control" title="Payment Status NOTES - Explain the reason for changing payment status " size="120" placeholder="Explain the reason for changing payment status" required>
                    </div>
                </div>
                <input id="paymentstatusbtn" name="paymentstatusbtn" type=button ng-click="UpdatePaymentStatus(dexedit.BillId, dexedit.PaymentStatus, dexedit.PayStatusDescription)" class="btn btn-primary format_button_med" value="Payment Status Update" />
                <a ng-href="#/expense/viewexpense" class="btn btn-primary format_button_small" ng-click="">Cancel</a>
            </div>
            <div class="content panel-body " ng-show="(userRole=='HOW National Team/Staff' || userRole=='National Staff' || userRole=='admin')">
                <label class="btn">
                    <input type="radio" ng-model="dexedit.PaymentStatus" value="Pending" disabled="true">
                    <span style=" font-size: 20px">Pending</span>
                </label>
                <label class="btn">
                    <input type="radio" ng-model="dexedit.PaymentStatus" value="Submitted">
                    <span style=" font-size: 20px">Submitted</span>
                </label>
                <label class="btn">
                    <input type="radio" ng-model="dexedit.PaymentStatus" value="Resubmit" disabled="true">
                    <span style=" font-size: 20px">Resubmit</span>
                </label>
                <label class="btn">
                    <input type="radio" ng-model="dexedit.PaymentStatus" value="Returned">
                    <span style=" font-size: 20px">Returned</span>
                </label>
                <label class="btn">
                    <input type="radio" ng-model="dexedit.PaymentStatus" value="Approved">
                    <span style=" font-size: 20px">Approved</span>
                </label>
                <label class="btn">
                    <input type="radio" ng-model="dexedit.PaymentStatus" value="Paid">
                    <span style=" font-size: 20px">Paid</span>
                </label>
                <label class="btn">
                    <input type="radio" ng-model="dexedit.PaymentStatus" value="Overage">
                    <span style=" font-size: 20px">Overage</span>
                </label>
                <div class="form-group row" style="padding-bottom:  6px;">
                    <label for="lpaystatusdescription" class="col-xs-12 col-form-label">Payment Status NOTES:</label>
                    <div class="col-md-8">
                        <input id="lpaystatusdescription" ng-model="dexedit.PayStatusDescription" type="text" class="form-control" title="Payment Status NOTES - Explain the reason for changing payment status " size="120" placeholder="Explain the reason for changing payment status" required>
                    </div>
                </div>
                <input id="paymentstatusbtn" name="paymentstatusbtn" type=button ng-click="UpdatePaymentStatus(dexedit.BillId, dexedit.PaymentStatus,   dexedit.PayStatusDescription)" class="btn btn-primary format_button_med" value="Payment Status Update" />
                <a ng-href="#/expense/viewexpense" class="btn btn-primary format_button_small" ng-click="">Cancel</a>
            </div>
        </div>
        </div>
        </div>
    </form>
</div>
<script type="text/ng-template" id="myModalContent.html">
    <div class="modal-header">
        <h3 class="modal-title" id="modal-title">Payment Status Log</h3>
    </div>
    <div class="modal-body" id="modal-body">
        <div>
            <table class="table table-striped table-bordered">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Updated By</th>
                        <th>Role</th>
                        <th>Reason</th>
                        <th>Status Changed to</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="item in  PayStatusLogList">
                        <td>
                            {{item.PayStatusDate}}
                        </td>
                        <td>
                            {{item.PayStatusBy}}
                        </td>
                        <td>
                            {{item.PayRole}}
                        </td>
                        <td>
                            {{item.PayStatusDescription}}
                        </td>
                        <td>
                            {{item.PayStatus}}
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary" type="button" ng-click="ok()">OK</button>
    </div>
</script>